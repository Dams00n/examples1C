Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ РАЗЛИЧНЫЕ
		|	Начисления.Сотрудник.Наименование КАК СотрудникНаименование,
		|	Начисления.Сотрудник.Код КАК ТабНомер,
		|	Начисления.ВидРасчета КАК ВидРасчета,
		|	Начисления.ПериодДействияНачало КАК ПериодДействияНачало,
		|	Начисления.ПериодДействияКонец КАК ПериодДействияКонец,
		|	Начисления.ОтработаноДней КАК ОтработаноДней,
		|	Начисления.ОтработаноЧасов КАК ОтработаноЧасов,
		|	Начисления.Результат КАК Результат,
		|	Начисления.Регистратор КАК Регистратор,
		|	КадроваяИсторияСотрудниковСрезПоследних.Сотрудник КАК Сотрудник
		|ПОМЕСТИТЬ ВТ_1
		|ИЗ
		|	РегистрСведений.КадроваяИсторияСотрудников.СрезПоследних КАК КадроваяИсторияСотрудниковСрезПоследних
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрРасчета.Начисления КАК Начисления
		|		ПО (Начисления.Сотрудник = КадроваяИсторияСотрудниковСрезПоследних.Сотрудник)
		|ГДЕ
		|	Начисления.ВидРасчета В(&ВидРасчета)
		|	И ТИПЗНАЧЕНИЯ(Начисления.Регистратор) = ТИП(Документ.НачислениеЗарплаты)
		|	И КадроваяИсторияСотрудниковСрезПоследних.ВидСобытия <> ЗНАЧЕНИЕ(Перечисление.ВидыКадровыхСобытий.Увольнение)
		|	И Начисления.ПериодРегистрации = &ПериодРегистрации
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	НачисленияПоказатели.Показатель КАК Показатель,
		|	ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Значение КАК Значение,
		|	НачисленияПоказатели.Ссылка КАК Ссылка,
		|	ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Сотрудник КАК Сотрудник
		|ПОМЕСТИТЬ ВТ_2
		|ИЗ
		|	ПланВидовРасчета.Начисления.Показатели КАК НачисленияПоказатели
		|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудников.СрезПоследних(, ) КАК ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних
		|		ПО НачисленияПоказатели.Показатель = ЗначенияПериодическихПоказателейРасчетаЗарплатыСотрудниковСрезПоследних.Показатель
		|ГДЕ
		|	НачисленияПоказатели.Ссылка = &ВидРасчета
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ВТ_1.ТабНомер КАК ТабНомер,
		|	ВТ_1.СотрудникНаименование КАК СотрудникНаименование,
		|	ВТ_1.ВидРасчета КАК ВидРасчета,
		|	ВТ_1.ПериодДействияНачало КАК ПериодДействияНачало,
		|	ВТ_1.ПериодДействияКонец КАК ПериодДействияКонец,
		|	ВТ_2.Показатель КАК Показатель1,
		|	ВТ_1.ОтработаноДней КАК ОтработаноДней,
		|	ВТ_1.ОтработаноЧасов КАК ОтработаноЧасов,
		|	ВТ_1.Результат КАК Результат,
		|	ВТ_1.Регистратор КАК Регистратор,
		|	ВТ_2.Значение КАК Значение
		|ИЗ
		|	ВТ_1 КАК ВТ_1
		|		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_2 КАК ВТ_2
		|		ПО ВТ_1.Сотрудник = ВТ_2.Сотрудник";
	
	Запрос.УстановитьПараметр("ВидРасчета", Объект.ВидРасчета);              
	Запрос.УстановитьПараметр("ПериодРегистрации", Объект.ПериодРегистрации);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();  
	
	
	
	
	ИмяФайла = "Unload"; 
	
	ИмяФайла = КаталогВременныхФайлов()+ "DoNocERP.dbf"; //Nomenk.dbf";   
	хВ = Новый xBase; 
	хВ.Кодировка = КодировкаXBase.OEM;
	хВ.Поля.Добавить("TN","S",50,0);
	хВ.Поля.Добавить("Name","S",50,0);
	хВ.Поля.Добавить("VidRasch","S",50,0);
	хВ.Поля.Добавить("DataN","S",50,0);
	хВ.Поля.Добавить("DataK","S",50,0);
	хВ.Поля.Добавить("Pokazatel","S",50,0);
	хВ.Поля.Добавить("Dni","S",50,0);
	хВ.Поля.Добавить("Chas","S",50,0);
	хВ.Поля.Добавить("Rezultat","S",50,0);
		
	хВ.СоздатьФайл(ИмяФайла);
	
  
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
			хВ.Добавить();	
			хВ.TN			= ВыборкаДетальныеЗаписи.ТабНомер;
			хВ.Name			= ВыборкаДетальныеЗаписи.СотрудникНаименование;
			хВ.VidRasch 	= ВыборкаДетальныеЗаписи.ВидРасчета;  
			хВ.DataN 		= ВыборкаДетальныеЗаписи.ПериодДействияНачало;	
			хВ.DataK 		= ВыборкаДетальныеЗаписи.ПериодДействияКонец;
			хВ.Pokazatel	= ВыборкаДетальныеЗаписи.Значение;
			хВ.Dni 	     	= ВыборкаДетальныеЗаписи.ОтработаноДней;
			хВ.Chas 		= ВыборкаДетальныеЗаписи.ОтработаноЧасов;  //ОплаченоДнейЧасов
			хВ.Rezultat		= ВыборкаДетальныеЗаписи.Результат;
			
	        хВ.Записать(); 	
	КонецЦикла;
	хВ.ЗакрытьФайл();
	
	Возврат ИмяФайла
